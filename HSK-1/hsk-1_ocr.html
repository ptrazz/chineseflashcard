<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tebak Hanzi — Penilaian Mandiri</title>
<style>
 body{font-family:system-ui;background:#0d1117;color:#eee;margin:0;padding:20px;text-align:center}
 .card{max-width:500px;margin:auto;background:#161b22;padding:20px;border-radius:14px;box-shadow:0 0 20px #0007}
 button{padding:10px 18px;border-radius:8px;border:none;margin:5px;font-size:16px;cursor:pointer;transition:transform 0.1s}
 button:active{transform:scale(.96)}
 button:disabled{cursor:not-allowed} 
 /* Styles for specific action buttons */
 #btnBenar { background:#238636; color:white; }
 #btnSalah { background:#db3939; color:white; }
 #btnShowAnswer { background:#30436d; color:white; }
 #hanziPad{width:100%;height:300px;background:white;border-radius:12px;border:2px solid #555;touch-action:none}
 .jawaban{font-size:48px;margin:15px 0;color:#4ad86e}
 .progress{width:100%;height:10px;background:#333;border-radius:6px;overflow:hidden;margin-top:10px}
 .bar{height:100%;width:0;background:#238636;transition:width 0.3s} 

 /* Container untuk tombol penilaian */
 .assessment-buttons {
     display: flex;
     justify-content: center;
     gap: 10px;
     margin-top: 15px;
 }
 .assessment-buttons button {
     width: 48%; /* Agar tombol memakan hampir setengah lebar */
 }
</style>
</head>
<body>
<h1>Tebak Hanzi — Penilaian Mandiri</h1>
<div class="card">
 <div id="showPinyin" style="font-size:32px;color:#7ff9a1;margin-bottom:4px"></div>
 <div id="showEnglish" style="font-size:20px;color:#cbd5e1;margin-bottom:14px"></div>
 
 <div class="progress">
     <div id="bar" class="bar"></div>
 </div>

 <div style="margin: 15px 0;">
    <span id="progressText" style="font-size:14px; color:#aaa;">0/20 selesai</span>
 </div>
 
 <h3>Gambar Hanzi:</h3>
 <canvas id="hanziPad"></canvas>

 <br>
 <button onclick="clearPad()">Hapus Gambar</button>
 <button id="btnShowAnswer" onclick="showAnswer()">Tampilkan Jawaban</button>
 
 <div id="notif" style="margin:10px 0 20px; color:#ddd"></div>
 
 <div id="jawaban" class="jawaban"></div>

 <div class="assessment-buttons">
    <button id="btnBenar" onclick="processAnswer(true)">✅ Benar</button>
    <button id="btnSalah" onclick="processAnswer(false)">❌ Salah</button>
 </div>
 
 <div style="margin-top:20px">
   <button onclick="prevCard()">Kembali</button>
   <button onclick="nextCard()">Lanjut</button>
 </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
<script>
let data = HSK1();
// Menggunakan array of objects untuk melacak status dan jawaban pengguna
let session = data.map((item, index) => ({ 
    ...item, 
    id: index, 
    status: 'pending' // 'pending', 'correct', 'incorrect'
}));

// Mengacak urutan yang hanya digunakan untuk iterasi, status tetap di `session`
let order = [...Array(data.length).keys()].sort(()=>Math.random()-0.5); 
let index = 0; // Index ke array 'order'
let score = 0; // Total jawaban benar

let canvas = document.getElementById('hanziPad');
let signaturePad;

// Storing DOM elements
const showPinyinEl = document.getElementById('showPinyin');
const showEnglishEl = document.getElementById('showEnglish');
const jawabanEl = document.getElementById('jawaban');
const notifEl = document.getElementById('notif');
const barEl = document.getElementById('bar');
const progressTextEl = document.getElementById('progressText');


function HSK1(){
 return [
        { hanzi: "我", pinyin: "wǒ", eng: "I, me" },
        { hanzi: "我们", pinyin: "wǒmen", eng: "we, us" },
        { hanzi: "你", pinyin: "nǐ", eng: "you" },
        { hanzi: "他", pinyin: "tā", eng: "he, him" },
        { hanzi: "她", pinyin: "tā", eng: "she, her" },
        { hanzi: "这", pinyin: "zhè", eng: "this" },
        { hanzi: "那", pinyin: "nà", eng: "that" },
        { hanzi: "哪", pinyin: "nǎ", eng: "which" },
        { hanzi: "哪儿", pinyin: "nǎr", eng: "where" },
        { hanzi: "谁", pinyin: "shéi", eng: "who" },
        { hanzi: "什么", pinyin: "shénme", eng: "what" },
        { hanzi: "多少", pinyin: "duōshǎo", eng: "how many" },
        { hanzi: "几", pinyin: "jǐ", eng: "how many" },
        { hanzi: "怎么", pinyin: "zěnme", eng: "how" },
        { hanzi: "怎么样", pinyin: "zěnmeyàng", eng: "how about" },
        { hanzi: "一", pinyin: "yī", eng: "one" },
        { hanzi: "二", pinyin: "èr", eng: "two" },
        { hanzi: "三", pinyin: "sān", eng: "three" },
        { hanzi: "四", pinyin: "sì", eng: "four" },
        { hanzi: "五", pinyin: "wǔ", eng: "five" },
        { hanzi: "六", pinyin: "liù", eng: "six" },
        { hanzi: "七", pinyin: "qī", eng: "seven" },
        { hanzi: "八", pinyin: "bā", eng: "eight" },
        { hanzi: "九", pinyin: "jiǔ", eng: "nine" },
        { hanzi: "十", pinyin: "shí", eng: "ten" },
        { hanzi: "个", pinyin: "gè", eng: "(measure word)" },
        { hanzi: "岁", pinyin: "suì", eng: "years old" },
        { hanzi: "本", pinyin: "běn", eng: "(books)" },
        { hanzi: "些", pinyin: "xiē", eng: "some" },
        { hanzi: "块", pinyin: "kuài", eng: "piece" },
        { hanzi: "不", pinyin: "bù", eng: "no" },
        { hanzi: "没", pinyin: "méi", eng: "not" },
        { hanzi: "很", pinyin: "hěn", eng: "very" },
        { hanzi: "太", pinyin: "tài", eng: "too" },
        { hanzi: "都", pinyin: "dōu", eng: "all" },
        { hanzi: "一点儿", pinyin: "yīdiǎnr", eng: "a little bit" },
        { hanzi: "和", pinyin: "hé", eng: "and" },
        { hanzi: "在", pinyin: "zài", eng: "at, in" },
        { hanzi: "的", pinyin: "de", eng: "(possessive)" },
        { hanzi: "了", pinyin: "le", eng: "(particle)" },
        { hanzi: "吗", pinyin: "ma", eng: "(question particle)" },
        { hanzi: "呢", pinyin: "ne", eng: "(particle)" },
        { hanzi: "喂", pinyin: "wèi", eng: "hello" },
        { hanzi: "家", pinyin: "jiā", eng: "home" },
        { hanzi: "学校", pinyin: "xuéxiào", eng: "school" },
        { hanzi: "饭店", pinyin: "fàndiàn", eng: "restaurant" },
        { hanzi: "商店", pinyin: "shāngdiàn", eng: "store" },
        { hanzi: "医院", pinyin: "yīyuàn", eng: "hospital" },
        { hanzi: "中国", pinyin: "Zhōngguó", eng: "China" },
        { hanzi: "北京", pinyin: "Běijīng", eng: "Beijing" },
        { hanzi: "上", pinyin: "shàng", eng: "up" },
        { hanzi: "下", pinyin: "xià", eng: "down" },
        { hanzi: "前面", pinyin: "qiánmiàn", eng: "front" },
        { hanzi: "后面", pinyin: "hòumiàn", eng: "behind" },
        { hanzi: "里", pinyin: "lǐ", eng: "inside" },
        { hanzi: "今天", pinyin: "jīntiān", eng: "today" },
        { hanzi: "明天", pinyin: "míngtiān", eng: "tomorrow" },
        { hanzi: "昨天", pinyin: "zuótiān", eng: "yesterday" },
        { hanzi: "上午", pinyin: "shàngwǔ", eng: "morning" },
        { hanzi: "中午", pinyin: "zhōngwǔ", eng: "noon" },
        { hanzi: "下午", pinyin: "xiàwǔ", eng: "afternoon" },
        { hanzi: "年", pinyin: "nián", eng: "year" },
        { hanzi: "月", pinyin: "yuè", eng: "month" },
        { hanzi: "号", pinyin: "hào", eng: "date" },
        { hanzi: "星期", pinyin: "xīngqī", eng: "week" },
        { hanzi: "点", pinyin: "diǎn", eng: "o'clock" },
        { hanzi: "分钟", pinyin: "fēnzhōng", eng: "minute" },
        { hanzi: "现在", pinyin: "xiànzài", eng: "now" },
        { hanzi: "时候", pinyin: "shíhou", eng: "time" },
        { hanzi: "爸爸", pinyin: "bàba", eng: "father" },
        { hanzi: "妈妈", pinyin: "māma", eng: "mother" },
        { hanzi: "儿子", pinyin: "érzi", eng: "son" },
        { hanzi: "女儿", pinyin: "nǚ'ér", eng: "daughter" },
        { hanzi: "老师", pinyin: "lǎoshī", eng: "teacher" },
        { hanzi: "学生", pinyin: "xuéshēng", eng: "student" },
        { hanzi: "同学", pinyin: "tóngxué", eng: "classmate" },
        { hanzi: "朋友", pinyin: "péngyǒu", eng: "friend" },
        { hanzi: "医生", pinyin: "yīshēng", eng: "doctor" },
        { hanzi: "先生", pinyin: "xiānsheng", eng: "sir" },
        { hanzi: "小姐", pinyin: "xiǎojiě", eng: "miss" },
        { hanzi: "衣服", pinyin: "yīfu", eng: "clothes" },
        { hanzi: "水", pinyin: "shuǐ", eng: "water" },
        { hanzi: "菜", pinyin: "cài", eng: "dish" },
        { hanzi: "米饭", pinyin: "mǐfàn", eng: "rice" },
        { hanzi: "水果", pinyin: "shuǐguǒ", eng: "fruit" },
        { hanzi: "苹果", pinyin: "píngguǒ", eng: "apple" },
        { hanzi: "茶", pinyin: "chá", eng: "tea" },
        { hanzi: "杯子", pinyin: "bēizi", eng: "cup" },
        { hanzi: "钱", pinyin: "qián", eng: "money" },
        { hanzi: "飞机", pinyin: "fēijī", eng: "airplane" },
        { hanzi: "出租车", pinyin: "chūzūchē", eng: "taxi" },
        { hanzi: "电视", pinyin: "diànshì", eng: "television" },
        { hanzi: "电脑", pinyin: "diànnǎo", eng: "computer" },
        { hanzi: "电影", pinyin: "diànyǐng", eng: "movie" },
        { hanzi: "天气", pinyin: "tiānqì", eng: "weather" },
        { hanzi: "猫", pinyin: "māo", eng: "cat" },
        { hanzi: "狗", pinyin: "gǒu", eng: "dog" },
        { hanzi: "东西", pinyin: "dōngxi", eng: "thing" },
        { hanzi: "人", pinyin: "rén", eng: "person" },
        { hanzi: "名字", pinyin: "míngzi", eng: "name" },
        { hanzi: "书", pinyin: "shū", eng: "book" },
        { hanzi: "汉语", pinyin: "hànyǔ", eng: "Chinese language" },
        { hanzi: "字", pinyin: "zì", eng: "character" },
        { hanzi: "桌子", pinyin: "zhuōzi", eng: "desk" },
        { hanzi: "椅子", pinyin: "yǐzi", eng: "chair" },
        { hanzi: "谢谢", pinyin: "xièxie", eng: "thank you" },
        { hanzi: "不客气", pinyin: "búkèqi", eng: "you're welcome" },
        { hanzi: "再见", pinyin: "zàijiàn", eng: "goodbye" },
        { hanzi: "请", pinyin: "qǐng", eng: "please" },
        { hanzi: "对不起", pinyin: "duìbuqǐ", eng: "sorry" },
        { hanzi: "没关系", pinyin: "méiguānxì", eng: "it's okay" },
        { hanzi: "是", pinyin: "shì", eng: "to be" },
        { hanzi: "有", pinyin: "yǒu", eng: "have" },
        { hanzi: "看", pinyin: "kàn", eng: "look" },
        { hanzi: "听", pinyin: "tīng", eng: "listen" },
        { hanzi: "说", pinyin: "shuō", eng: "speak" },
        { hanzi: "读", pinyin: "dú", eng: "read" },
        { hanzi: "写", pinyin: "xiě", eng: "write" },
        { hanzi: "看见", pinyin: "kànjiàn", eng: "see" },
        { hanzi: "叫", pinyin: "jiào", eng: "call" },
        { hanzi: "来", pinyin: "lái", eng: "come" },
        { hanzi: "回", pinyin: "huí", eng: "return" },
        { hanzi: "去", pinyin: "qù", eng: "go" },
        { hanzi: "吃", pinyin: "chī", eng: "eat" },
        { hanzi: "喝", pinyin: "hē", eng: "drink" },
        { hanzi: "睡觉", pinyin: "shuìjiào", eng: "sleep" },
        { hanzi: "打电话", pinyin: "dǎ diànhuà", eng: "make a call" },
        { hanzi: "做", pinyin: "zuò", eng: "do" },
        { hanzi: "买", pinyin: "mǎi", eng: "buy" },
        { hanzi: "开", pinyin: "kāi", eng: "open" },
        { hanzi: "坐", pinyin: "zuò", eng: "sit" },
        { hanzi: "住", pinyin: "zhù", eng: "live" },
        { hanzi: "学习", pinyin: "xuéxí", eng: "study" },
        { hanzi: "工作", pinyin: "gōngzuò", eng: "work" },
        { hanzi: "下雨", pinyin: "xiàyǔ", eng: "rain" },
        { hanzi: "爱", pinyin: "ài", eng: "love" },
        { hanzi: "喜欢", pinyin: "xǐhuān", eng: "like" },
        { hanzi: "想", pinyin: "xiǎng", eng: "want" },
        { hanzi: "认识", pinyin: "rènshi", eng: "know" },
        { hanzi: "会", pinyin: "huì", eng: "can" },
        { hanzi: "能", pinyin: "néng", eng: "able to" },
        { hanzi: "好", pinyin: "hǎo", eng: "good" },
        { hanzi: "大", pinyin: "dà", eng: "big" },
        { hanzi: "小", pinyin: "xiǎo", eng: "small" },
        { hanzi: "多", pinyin: "duō", eng: "many" },
        { hanzi: "少", pinyin: "shǎo", eng: "few" },
        { hanzi: "冷", pinyin: "lěng", eng: "cold" },
        { hanzi: "热", pinyin: "rè", eng: "hot" },
        { hanzi: "高兴", pinyin: "gāoxìng", eng: "happy" },
        { hanzi: "漂亮", pinyin: "piàoliang", eng: "beautiful" },
      ];
}

function resizeCanvas(){
 const ratio = window.devicePixelRatio || 1;
 canvas.width = canvas.clientWidth * ratio;
 canvas.height = canvas.clientHeight * ratio;
 const ctx = canvas.getContext("2d");
 ctx.scale(ratio, ratio);
 if(signaturePad){ 
    signaturePad._ctx = ctx; 
    signaturePad.clear(); 
 }
}

function init(){
 resizeCanvas();
 signaturePad = new SignaturePad(canvas,{backgroundColor:'white',penColor:'black'});
 updateProgress();
 tampilkan();
}

window.onload = init;
window.onresize = resizeCanvas;

function tampilkan(){
 let itemIndex = order[index];
 let item = session[itemIndex];

 showPinyinEl.textContent = item.pinyin;
 showEnglishEl.textContent = item.eng;
 jawabanEl.innerHTML = "";
 notifEl.innerHTML = "";
 clearPad();
 
 // Menampilkan status sebelumnya (jika ada)
 if (item.status === 'correct') {
     notifEl.innerHTML = "<span style='color:#4ad86e'>Sudah dijawab dengan Benar!</span>";
 } else if (item.status === 'incorrect') {
     notifEl.innerHTML = "<span style='color:#ff5757'>Sudah dijawab dengan Salah. Coba lagi!</span>";
 } else {
     notifEl.innerHTML = "Silakan gambar Hanzi di atas.";
 }
}

function nextCard(){ 
    if(index < order.length-1){ 
        index++; 
        tampilkan(); 
    } else {
        notifEl.innerHTML = "<span style='color:orange'>Semua kartu sudah selesai. Silakan kembali ke kartu sebelumnya.</span>";
    }
}

function prevCard(){ 
    if(index > 0){ 
        index--; 
        tampilkan(); 
    } else {
        notifEl.innerHTML = "<span style='color:orange'>Ini adalah kartu pertama.</span>";
    }
}

function showAnswer(){ 
    jawabanEl.innerHTML = session[order[index]].hanzi;
    notifEl.innerHTML = "Ini adalah jawaban yang benar. Apakah gambarmu sudah mirip?";
}

function clearPad(){ signaturePad.clear(); }

// Fungsi untuk memperbarui status dan melanjutkan ke kartu berikutnya
function processAnswer(isCorrect) {
    let itemIndex = order[index];
    let currentItem = session[itemIndex];
    
    // Hanya perbarui status jika sebelumnya belum pernah dijawab BENAR
    if (currentItem.status !== 'correct') {
        currentItem.status = isCorrect ? 'correct' : 'incorrect';
    }

    if (isCorrect) {
        notifEl.innerHTML = "<span style='color:#4ad86e'>Bagus! Lanjut ke kartu berikutnya.</span>";
        jawabanEl.innerHTML = currentItem.hanzi;
    } else {
        notifEl.innerHTML = "<span style='color:#ff5757'>Oke. Pelajari lagi dan coba gambar ulang, atau lanjut ke kartu berikutnya.</span>";
    }
    
    updateProgress();
    
    // Pindah ke kartu berikutnya setelah jeda singkat
    setTimeout(nextCard, 1500);
}

function updateProgress(){
    let total = session.length;
    let answered = session.filter(item => item.status !== 'pending').length;
    let correctCount = session.filter(item => item.status === 'correct').length;
    
    let pct = (answered / total) * 100;
    barEl.style.width = pct + "%";
    
    progressTextEl.textContent = `${correctCount}/${total} benar (${answered} selesai)`;
    
    // Perbarui warna progress bar berdasarkan persentase
    if (pct < 50) {
         barEl.style.backgroundColor = '#db3939'; // Merah
    } else if (pct < 100) {
         barEl.style.backgroundColor = '#ffc107'; // Kuning
    } else {
         barEl.style.backgroundColor = '#238636'; // Hijau
    }
}
</script>
</body>
</html>

